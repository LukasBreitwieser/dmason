<!--
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../../bower_components/paper-styles/typography.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../bower_components/neon-animation/neon-shared-element-animatable-behavior.html">
<link rel="import" href="../../bower_components/neon-animation/animations/ripple-animation.html">
<link rel="import" href="../../bower_components/neon-animation/animations/hero-animation.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-icons/av-icons.html">

<dom-module id="animated-grid">
    <template>
        <style>
            :host {
                display: block;
            }

            .grid-item-simulations:hover{
                /*background-color: grey;*/
                border-color: white;
            }

            .grid-sizer-simulations,
            .grid-item-simulations
            {
                width: 300px;
                heigth:300px;
            }


            .grid-simulations:after {
                content: '';
                display: block;
                clear: both;
            }

            .grid-simulations {
                background: transparent;
                max-width: 100%;
            }

            .grid-item-simulations {
                width:300px;
                height:300px;
                float: left;
                background-color: #3f4242;
                border: 2px solid #0c3308;
                border-color: hsla(0, 0%, 0%, 0.5);
                border-radius: 5px;
                font-size: large;
                padding:10px;
                position:relative;
            }

            paper-button{
                width: 20px;
                margin:0;
            }

        </style>


        <div class="grid-simulations">
            <div class="grid-sizer-simulations"></div>
            <template is="dom-repeat" items="{{listItem}}" as="sim">
                <div class="grid-item-simulations" id="sim-{{index}}">
                    <table>
                        <tr><td><span>ID:</span></td><td><span>{{sim.id}}</span></td></tr>
                        <tr><td><span>Name:</span></td><td><span>{{sim.name}}</span></td></tr>
                        <tr><td><span>Partitioning:</span></td><td><span>{{sim.partitioning}}</span></td></tr>
                        <tr><td><span>Num. of Cells:</span></td><td><span>{{sim.num_cell}}</span></td></tr>
                        <tr><td><span>Num. of Worker:</span></td><td><span>{{sim.num_worker}}</span></td></tr>
                        <tr><td><span>Time:</span></td><td><span id="time">{{getSimTime(sim.start)}}</span></td></tr>
                        <tr><td><span>Steps:</span></td><td><span id="step">{{getNumStep(sim.step)}}</span></td></tr>
                        <tr><td colspan="2">
                                <paper-button raised disabled><iron-icon icon="av:play-circle-filled"></iron-icon>Resume</paper-button>
                                <paper-button raised><iron-icon icon="av:pause-circle-outline"></iron-icon>Pause</paper-button>
                                <paper-button raised><iron-icon icon="av:stop"></iron-icon>Stop</paper-button>
                            </td></tr>
                    </table>
                    <!--span>ID: {{sim.id}}</span><br>
                    <span>Name: {{sim.name}}</span>
                    <span>Start: {{sim.start}}</span-->
                </div>
            </template>
        </div>
    </template>
</dom-module>

<script>
    Polymer({
        is: 'animated-grid',
        behaviors: [
            Polymer.NeonSharedElementAnimatableBehavior
        ],
        getNumStep: function(step){
            setInterval(function(step){ return step+1 }, 1000);
        },

        getSimTime: function(start){
            setInterval(function(start){ return start+1 }, 1);
        },
        properties: {
            listItem:{
                type:Array
            },
            animationConfig: {
                type: Object,
                value: function() {
                    return {
                        'exit': [{
                            name: 'ripple-animation',
                            id: 'ripple',
                            fromPage: this
                        },
                        {
                            name: 'hero-animation',
                            id: 'hero',
                            fromPage: this
                        }]
                    }
                }
            }
        },
        attached: function(){
            this.async(function(){
                $('.grid-simulations').masonry({
                            itemSelector: '.grid-item-simulations',
                            columnWidth: '.grid-sizer-simulations',
                            percentPosition: true
                        }
                );
            });
        },
        listeners: {
            click: '_onClick'
        },


        _onClick: function(event) {

            var target = event.target;
            while(target.classList[0] != "grid-item-simulations")
                target = target.parentElement;

            // configure the page animation
            this.sharedElements = {
                'hero': target,
                'ripple': target
            };
            this.animationConfig['exit'][0].gesture = {
                x: event.x || event.pageX,
                y: event.y || event.pageY
            };
            this.fire('tile-click', {
                tile: target,
                //data : target.id
                data: target._templateInstance.sim
            });
        }
    });
</script>